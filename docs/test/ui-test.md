# UI自動化テスト仕様書

## 概要
Seleniumを使用した得意先マスタ画面のUI自動化テストに関する仕様を記載します。

## テストの目的
1. 画面操作を通じた機能の正常動作確認
2. ユーザーインターフェースの一貫性確認
3. 入力バリデーションの確認
4. エラー処理の確認

## テストケース一覧

### 1. 基本操作テスト（testCustomerCRUDOperations）

#### 1.1 新規登録
| テストケース | 期待結果 |
|------------|---------|
| 得意先の新規登録 | 登録が成功し、成功メッセージが表示されること |
| 登録内容の確認 | 登録した内容が一覧に表示されること |

#### 1.2 検索・表示
| テストケース | 期待結果 |
|------------|---------|
| 登録した得意先の検索 | 検索結果に登録した得意先が表示されること |
| 詳細情報の確認 | 登録した内容が正しく表示されること |

#### 1.3 更新
| テストケース | 期待結果 |
|------------|---------|
| 得意先情報の更新 | 更新が成功し、成功メッセージが表示されること |
| 更新内容の確認 | 更新した内容が一覧に反映されていること |

#### 1.4 削除
| テストケース | 期待結果 |
|------------|---------|
| 得意先の削除 | 削除が成功し、成功メッセージが表示されること |
| 削除の確認 | 削除した得意先が検索結果に表示されないこと |

### 2. バリデーションテスト（testCustomerValidation）

#### 2.1 必須項目チェック
| テストケース | 期待結果 |
|------------|---------|
| 空の入力で保存 | エラーメッセージが表示されること |
| 得意先コードの重複 | 重複エラーメッセージが表示されること |

#### 2.2 キャンセル操作
| テストケース | 期待結果 |
|------------|---------|
| 編集のキャンセル | 一覧画面に戻り、変更が適用されないこと |

### 3. 検索機能テスト（testCustomerSearch）

#### 3.1 検索条件
| テストケース | 期待結果 |
|------------|---------|
| 顧客コードでの検索 | 指定した顧客コードの得意先のみが表示されること |
| 名前での検索 | 名前に一致する得意先が表示されること |
| 複数条件での検索 | 両方の条件に一致する得意先が表示されること |
| 該当なしの検索 | 検索結果が0件となること |

### 4. Excel機能テスト（testExcelOperations）

#### 4.1 Excel出力
| テストケース | 期待結果 |
|------------|---------|
| Excel出力の実行 | 得意先一覧がExcelファイルとしてダウンロードされること |
| 出力内容の確認 | 出力されたファイルに画面の内容が正しく反映されていること |
| ヘッダー行の確認 | 適切なヘッダー（顧客コード、名前、カナ名など）が設定されていること |

#### 4.2 Excel取込テンプレート
| テストケース | 期待結果 |
|------------|---------|
| テンプレートのダウンロード | 取込用のテンプレートファイルがダウンロードされること |
| テンプレート形式の確認 | 必要な列（顧客コード、名前、カナ名など）が含まれていること |

#### 4.3 Excel取込
| テストケース | 期待結果 |
|------------|---------|
| 正常データの取込 | データが正しく取り込まれ、成功メッセージが表示されること |
| 取込結果の確認 | 取り込んだデータが一覧に表示されること |
| 不正データの取込 | 適切なエラーメッセージが表示され、取込が中止されること |
| 重複データの取込 | 重複エラーメッセージが表示され、取込が中止されること |

### 5. フォームバリデーションテスト（testCustomerFormValidation）

#### 5.1 入力形式チェック
| テストケース | 期待結果 |
|------------|---------|
| 不正な郵便番号形式 | フォーマットエラーメッセージが表示されること |
| 不正なメールアドレス形式 | フォーマットエラーメッセージが表示されること |
| 文字数制限超過 | 文字数制限エラーメッセージが表示されること |

## テスト環境

### 1. 使用技術
- Selenium WebDriver
- JUnit 5
- Chrome Driver（ヘッドレスモード）
- Page Object Model

### 2. テストデータ
```sql
INSERT INTO customers (customer_code, name, ...) VALUES
('CUST001', 'テスト株式会社1', ...),
('CUST002', 'テスト株式会社2', ...),
('CUST003', 'テスト株式会社3', ...);
```

### 3. ページオブジェクト
CustomerPage.javaで以下の機能を提供：
- 画面要素へのアクセス
- 画面操作の抽象化
- 画面の状態確認
- 要素の待機処理

## テストの実行方法

### 1. 前提条件
- Chrome Driverのインストール
- テストデータベースの準備
- アプリケーションサーバーの起動

### 2. 実行コマンド
```bash
# 全てのUIテストを実行
mvn test -Dtest=CustomerUITest

# 特定のテストメソッドを実行
mvn test -Dtest=CustomerUITest#testCustomerCRUDOperations
```

## 注意事項

1. テストの独立性
   - 各テストは独立して実行可能
   - テストデータは各テスト実行時にリセット
   - テスト間の依存関係なし

2. 画面要素の待機
   - 明示的な待機処理の実装
   - タイムアウトの適切な設定
   - 動的な要素の処理

3. エラー処理
   - 要素が見つからない場合の処理
   - タイムアウト時の処理
   - 予期しないアラートの処理

## 今後の課題

1. テストカバレッジの向上
   - より多くのユースケースの追加
   - エッジケースの追加
   - 異常系テストの拡充

2. パフォーマンス改善
   - テスト実行時間の短縮
   - 並行実行の検討
   - リソース使用の最適化

3. 保守性の向上
   - ページオブジェクトの共通化
   - テストデータの管理改善
   - ログ出力の強化

4. クロスブラウザテスト
   - 複数ブラウザでのテスト
   - モバイル対応のテスト
   - レスポンシブデザインのテスト